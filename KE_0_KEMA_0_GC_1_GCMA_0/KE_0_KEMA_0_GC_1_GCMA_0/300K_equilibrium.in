# Variable                                                                                                                              
variable		npt_step	equal	50000000           # 50 ns                                                                            
variable		npt_thermo	equal	${npt_step}/100    # output 100 frame                                                                 
units           real                                                                                                                    
variable        filename    string  KE_0_KEMA_0_GC_1_GCMA_0_autopsf_solvate_ionzied.data
                                                                                                                                        
# Potential define                                                                                                                      
newton          off                                                                                                                     
atom_style      full                                                                                                                    
bond_style      harmonic                                                                                                                
angle_style     charmm                                                                                                                  
dihedral_style  charmmfsw                                                                                                               
improper_style  harmonic                                                                                                                
pair_style      lj/charmmfsw/coul/charmmfsh 10 12                                                                                     
# pair_style      lj/charmmfsw/coul/long 10 12                                                                                            
# kspace_style    pppm 1e-6                                                                                                               
pair_modify     mix arithmetic                                                                                                          
                                                                                                                                        
# Modify following line to point to the desired CMAP file                                                                               
fix             cmap all cmap charmm36.cmap                                                                          
fix_modify      cmap energy yes                                                                                                         
read_data       ${filename} fix cmap crossterm CMAP                                                                                        

special_bonds   charmm                                                                                                                  
                                                                                                                                        
velocity        all create 303.15 23112 dist gaussian 
fix 			1 all npt temp 300.0 300.0 100.0 iso 1 1 1000.0
# Minimized                                                                                                                             
neigh_modify    every 1 delay 0 check yes                                                                                               
min_style       cg                                                                                                                      
minimize        0.0 1.0e-9 100000 1000000                                                                                                  
write_data      minimized.data pair ij                                                                                                  
                                                                                                                                        
# Setup                                                                                                                                 
                                                                                                                                        
neigh_modify    delay 5 every 1                                                                                                         
restart 		${npt_thermo} ./restart/300K_equilibrium.restart                                                                                       
dump            1 all dcd ${npt_thermo} 300K_equilibrium.dcd                                                                                         
dump_modify     1 unwrap yes                                                                                                            
thermo          ${npt_thermo}                                                                                                           
thermo_style    custom step time xlo xhi ylo yhi zlo zhi etotal pe ke ebond temp press eangle edihed eimp evdwl ecoul elong vol density 
                                                                                                                                        
# NPT 300K                                                                                                                              
reset_timestep  0                                                                                                                       

timestep        0.5                                                                                                                     
run             ${npt_step}                                                                                                             
                                                                                                                                        
write_data      300K_equilibrium.data pair ij                                                                                                    
write_dump      all custom 300K_equilibrium.dump id type x y z vx vy vz ix iy iz
